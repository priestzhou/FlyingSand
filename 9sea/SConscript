Import('env')

env.install(env.compileAndJar('agent.jar', 'agent', 
    libs=[env['CLOJURE'],
        env.File('$BUILD_DIR/argparser.jar'),
        env.File('$EXTLIB/ring-1.1.8.jar'),
        env.File('$EXTLIB/ring-jetty-adapter-1.1.8.jar'),
        env.File('$EXTLIB/compojure-1.1.5.jar'),
        env.File('$EXTLIB/data.json-0.2.2.jar'),
        env.File('$EXTLIB/java.jdbc-0.3.0-alpha5.jar'),
        env.File('$EXTLIB/mysql-connector-java-5.1.26-bin.jar'),
        env.File('$BUILD_DIR/logging.jar'),
        env.File('$BUILD_DIR/utilities.jar'),   
        env.File('$BUILD_DIR/monitor.jar')               
    ], 
    standalone=True, manifest={'Main-Class': 'agent.main'}))

env.install(env.compileAndJar('monitor.jar', 'monitor', 
    libs=[env['CLOJURE'],
        env.File('$BUILD_DIR/utilities.jar'),
        env.File('$BUILD_DIR/argparser.jar'),
        env.File('$EXTLIB/ring-1.1.8.jar'),
        env.File('$EXTLIB/ring-jetty-adapter-1.1.8.jar'),
        env.File('$EXTLIB/compojure-1.1.5.jar'),
    ], 
    standalone=True, manifest={'Main-Class': 'monitor.main'}))

parser = env.compileAndJar('parser.jar', 'parser',
    libs=[env['CLOJURE'],
        env.File('$BUILD_DIR/utilities.jar'),
        env.File('$BUILD_DIR/argparser.jar'),
        env.File('$BUILD_DIR/logging.jar'),
    ])
env.install(env.compileAndJar('parser_unittest.jar', 'parser_unittest', 
    libs=[env['CLOJURE'],
        env.File('$BUILD_DIR/testing.jar'),
        env.File('$BUILD_DIR/utilities.jar'),
        env.File('$BUILD_DIR/argparser.jar'),
        env.File('$BUILD_DIR/logging.jar'),
        parser, 
    ], 
    standalone=True, manifest={'Main-Class': 'parser_unittest.main'}))
env.install(env.compileAndJar('sql_parser.jar', 'parser',
    libs=[env['CLOJURE'],
        env.File('$BUILD_DIR/utilities.jar'),
        env.File('$BUILD_DIR/argparser.jar'),
        env.File('$BUILD_DIR/logging.jar'),
    ], 
    standalone=True, manifest={'Main-Class': 'parser.main'}))

env.install(env.compileAndJar('query_server.jar', 'query_server',
    libs=[env['CLOJURE'], 
        env.File('$EXTLIB/ring-1.1.8.jar'),
        env.File('$EXTLIB/ring-jetty-adapter-1.1.8.jar'),
        env.File('$EXTLIB/compojure-1.1.5.jar'),
        env.File('$EXTLIB/lib-for-shark/hive-jdbc-0.9.0.jar'),
        env.File('$EXTLIB/korma-0.3.0-RC6.jar'),
        env.File('$EXTLIB/mysql-connector-java-5.1.6.jar'),
        env.File('$EXTLIB/c3p0-0.9.2.1.jar'),
        env.File('$EXTLIB/data.json-0.2.2.jar'),
        env.File('$EXTLIB/slingshot-0.10.3.jar'),
        env.File('$EXTLIB/lib-for-shark/hive-metastore-0.9.0.jar'),
        env.File('$EXTLIB/lib-for-shark/hive-metastore-0.9.0-amplab-4.jar'),
        env.File('$EXTLIB/lib-for-shark/libthrift-0.7.0.jar'),
        env.File('$EXTLIB/lib-for-shark/hive-service-0.9.0-amplab-4.jar'),
        env.File('$EXTLIB/lib-for-shark/hive-service-0.9.0.jar'),
        env.File('$EXTLIB/lib-for-shark/libfb303-0.7.0.jar'),
        env.File('$EXTLIB/lib-for-shark/hive-serde-0.9.0-amplab-4.jar'),
        env.File('$EXTLIB/lib-for-shark/hadoop-common-2.0.0-cdh4.3.0.jar'),
        env.File('$EXTLIB/lib-for-shark/hadoop-core-2.0.0-mr1-cdh4.3.0.jar'),
        env.File('$EXTLIB/lib-for-shark/commons-logging-api-1.0.4.jar'),
        env.File('$EXTLIB/lib-for-shark/commons-logging-1.0.4.jar'),
        env.File('$EXTLIB/lib-for-shark/log4j-1.2.16.jar'),
        env.File('$EXTLIB/lib-for-shark/slf4j-log4j12-1.6.1.jar'),
        env.File('$EXTLIB/lib-for-shark/hive-common-0.9.0-amplab-4.jar'),
        env.File('$EXTLIB/lib-for-shark/hive-common-0.9.0.jar'),
        env.File('$EXTLIB/lib-for-shark/hive-contrib-0.9.0-amplab-4.jar'),
        env.File('$EXTLIB/lib-for-shark/hive-contrib-0.9.0.jar'),
        env.File('$BUILD_DIR/utilities.jar'),
        env.File('$BUILD_DIR/argparser.jar'),
        env.File('$BUILD_DIR/logging.jar'),
        env.File('$EXTLIB/http-kit-2.1.10.jar'),
        env.File('$EXTLIB/hdfs-clj-0.1.8.jar'),
        env.File('$EXTLIB/hadoop-hdfs-2.0.0-cdh4.3.0.jar'),
        env.File('$EXTLIB/sqlite-jdbc-3.8.0-20130827.035027-1.jar'),
        env.File('$EXTLIB/clojure-contrib-1.2.0.jar'),
        env.File('$EXTLIB/data.csv-0.1.2.jar'),
        parser,
    ],
    install={},
    standalone=True, manifest={'Main-Class': 'query_server.main'}))


env.install(env.compileAndJar('9sea_unittest.jar', 'unittest',
    libs=[env['CLOJURE'], 
        env.File('$EXTLIB/tools.cli-0.2.2.jar'),
        env.File('$BUILD_DIR/testing.jar'),
        env.File('$BUILD_DIR/agent.jar'),
        env.File('$BUILD_DIR/query_server.jar'),
        env.File('$EXTLIB/clj-time-0.5.2.jar'),
        env.File('$EXTLIB/lib-for-shark/hive-jdbc-0.9.0.jar'),
        env.File('$EXTLIB/ring-1.1.8.jar'),
        env.File('$EXTLIB/ring-jetty-adapter-1.1.8.jar'),
        env.File('$EXTLIB/java.jdbc-0.3.0-alpha5.jar'),
        ],

    standalone=True, manifest={'Main-Class': 'unittest.main'}))
env.install(env.compileAndJar('9sea_smoketest.jar', 'smoketest',
    libs=[env['CLOJURE'], 
        env.File('$EXTLIB/tools.cli-0.2.2.jar'),
        env.File('$BUILD_DIR/testing.jar'),
        env.File('$BUILD_DIR/utilities.jar'),
        env.File('$BUILD_DIR/monitor.jar'),
        env.File('$EXTLIB/data.json-0.2.2.jar'),
        env.File('$BUILD_DIR/query_server.jar'),
        
    ],
    standalone=True, manifest={'Main-Class': 'smoketest.main'}))

env.install(env.compileAndJar('9sea_agent_testtool.jar', 'agent_testtool',
    libs=[env['CLOJURE'], 
        env.File('$BUILD_DIR/utilities.jar'),
        env.File('$BUILD_DIR/argparser.jar'),
        env.File('$EXTLIB/data.json-0.2.2.jar'),
        env.File('$EXTLIB/java.jdbc-0.3.0-alpha5.jar'),
        env.File('$EXTLIB/mysql-connector-java-5.1.26-bin.jar'),
        ],
    standalone=True, manifest={'Main-Class': 'agent_testtool.main'}))


